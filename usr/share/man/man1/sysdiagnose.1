.Dd January 24, 1984   \" DATE
.Dt sysdiagnose 1      \" Program name and manual section number 
.Os OS X
.Sh NAME               \" Section Header - required - don't modify
.Nm sysdiagnose
.\" The following lines are read in generating the apropos(man -k) database. Use only key
.\" words here as the database is built based on the words here and in the .ND line. 
.\" Use .Nm macro to designate other names for the documented program.
.Nd gathers system-wide diagnostic information helpful in investigating system performance issues
.\" ============================================================================
.\" ========================== BEGIN SYNOPSIS SECTION ==========================
.Sh SYNOPSIS
.Nm
.Fl h
.Nm
.Op Fl f Ar results_directory
.Op Fl A Ar archive_name
.Op Fl q
.Op Fl b
.Op Fl p
.Op Fl d
.Op Fl X
.Op Ar process_name | pid
.\" =========================== END SYNOPSIS SECTION ===========================
.\" ============================================================================
.\"
.\" ============================================================================
.\" ======================== BEGIN DESCRIPTION SECTION =========================
.Sh DESCRIPTION          \" Section Header - required - don't modify
The
.Nm
tool gathers system diagnostic information helpful in investigating system performance issues. A great deal of information is harvested, spanning system state and configuration.
.Nm
needs to be run as root.
.Nm
is automatically triggered when the following key chord is pressed: Control-Option-Command-Shift-Period.
.\" ----------------------------------------------------------------------------
.\" ----------------------- BEGIN DIAGNOSTICS LIST -----------------------------
.Ss What Nm Sy collects:
.Bl -bullet -offset indent -compact
.It
A spindump of the system
.It
Several seconds of fs_usage ouput 
.It
Several seconds of top output
.It
Data about kernel zones
.It
Status of loaded kernel extensions 
.It
Resident memory usage of user processes
.It
Recent system logs
.It
A System Profiler report
.It
Recent crash reports
.It
Disk usage information
.It
I/O Kit registry information
.It
Network status
.It
If a specific process is supplied as an argument: list of malloc-allocated buffers in the process's heap is collected
.It
If a specific process is supplied as an argument: data about unreferenced malloc buffers in the process's memory is collected 
.It
If a specific process is supplied as an argument: data about the virtual memory regions allocated in the process
.El
.\" ----------------------------------------------------------------------------
.\" ========================== END DIAGNOSTICS LIST ============================
.\" ----------------------------------------------------------------------------
.\" ========================== END DESCRIPTION SECTION =========================
.\" ============================================================================
.\"
.\" ============================================================================
.\" =========================== BEGIN OPTIONS SECTION ==========================
.Sh OPTIONS
.Bl -tag -width -indent 
.It Fl h
Display help.
.It Fl f Ar results_directory
Specify the directory where the results will be stored. The default results directory is /var/tmp.
.It Fl A Ar archive_name
Specify the name of the archive created in the results directory.
.It Fl q
Skip footprint.
.It Fl b
Do not show the resulting archive in a Finder window upon completion.
.It Fl p
Request only time-sensitive data to be collected (performance issues).
.It Fl d
Request only log data to be collected (historical issues).
.It Fl X
Run all diagnostics with no timeout.
.It Ar process_name | pid
If a single process appears to be slowing down the system, passing in the process name or ID as the argument gathers additional process-specific diagnostic data.
.El
.\" =========================== END OPTIONS SECTION ============================
.\" ============================================================================
.\" ============================================================================
.\" ======================== BEGIN EXIT STATUS SECTION =========================
.Sh EXIT STATUS
.Nm
exits with status 0 if there were no internal errors encountered during the diagnostic, or >0 when an error unrelated to external state occurs or unusable input is provided by the user.
.\" ========================= END EXIT STATUS SECTION ==========================
.\" ============================================================================
